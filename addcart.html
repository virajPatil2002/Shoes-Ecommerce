<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Your Shopping Cart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

  <section class="py-5 bg-white">
    <div class="container">
      <h2 class="mb-4 fw-bold">Your Shopping Cart</h2>
      <div class="table-responsive">
        <table class="table align-middle" id="cart-table">
          <thead class="table-dark">
            <tr>
              <th>Product</th>
              <th class="text-center">Price</th>
              <th class="text-center">Quantity</th>
              <th class="text-center">Total</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="cart-body"></tbody>
        </table>
      </div>
      <div class="row mt-4">
        <div class="col-md-6">
          <a href="./product.html" class="btn btn-outline-secondary">Continue Shopping</a>
        </div>
        <div class="col-md-6 text-end">
          <h5 class="fw-bold">Subtotal: $<span id="subtotal">0.00</span></h5>
          <a href="./payment.html" class="btn btn-success btn-lg mt-2">Proceed to Checkout</a>
        </div>
      </div>
    </div>
  </section>

  <script>
   
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    function updateCartDisplay() {
      const cartBody = document.getElementById('cart-body');
      cartBody.innerHTML = '';
      let subtotal = 0;

      cart.forEach((item, index) => {
        const total = item.price * item.quantity;
        subtotal += total;

        const row = document.createElement('tr');
        row.innerHTML = `
        <td class="d-flex align-items-center">
          <img src="${item.image}" alt="${item.name}" class="img-thumbnail me-3" style="width: 70px; height: 70px; object-fit: cover;">
          <span>${item.name}</span>
        </td>
        <td class="text-center">$${item.price.toFixed(2)}</td>
        <td class="text-center">
          <input type="number" class="form-control form-control-sm text-center quantity-input" value="${item.quantity}" min="1" data-index="${index}" style="width: 70px; margin:auto;">
        </td>
        <td class="text-center">$${total.toFixed(2)}</td>
        <td class="text-center">
          <button class="btn btn-sm btn-outline-danger remove-btn" data-index="${index}">Remove</button>
        </td>
      `;
        cartBody.appendChild(row);
      });

      document.getElementById('subtotal').textContent = subtotal.toFixed(2);
      localStorage.setItem("cart", JSON.stringify(cart)); // Save cart to localStorage

      // Quantity change event
      document.querySelectorAll('.quantity-input').forEach(input => {
        input.addEventListener('change', e => {
          const idx = e.target.getAttribute('data-index');
          const value = parseInt(e.target.value);
          cart[idx].quantity = value > 0 ? value : 1;
          updateCartDisplay();
        });
      });

      // Remove button event
      document.querySelectorAll('.remove-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          const idx = e.target.getAttribute('data-index');
          cart.splice(idx, 1);
          updateCartDisplay();
        });
      });
    }

    // Initialize cart display on page load
    updateCartDisplay();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>